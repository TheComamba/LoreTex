
\begin{luacode*}
dofile(RelativePath .. "entities.lua")
\end{luacode*}


\newcommand{\setContinent}[1]{
	\directlua{
		CurrentContinent = "#1"
		CurrentRegion = ""
		CurrentCity = ""
	}
}

\newcommand{\setRegion}[1]{
	\directlua{
		CurrentRegion = "#1"
		CurrentCity = ""
	}
}

\newcommand{\setCity}[1]{
	\directlua{
		CurrentCity = "#1"
	}
}

\newcommand{\resetCurrentLabels}{
	\directlua{
		CurrentContinent = ""
		CurrentRegion = ""
		CurrentCity = ""
		CurrentLabel = ""
	}
}

\newcommand{\newEntity}[4]{
	\directlua{
		NewEntity("#1","#2", [[\detokenize{#3}]], [[\detokenize{#4}]])
	}
}

\newcommand{\newContinent}[3]{
	\newEntity{#1}{continent}{#2}{#3}
	\setContinent{#1}
}

\newcommand{\newRegion}[3]{
	\newEntity{#1}{region}{#2}{#3}
	\directlua{SetDescriptor(CurrentLabel,"parent", CurrentContinent)}
	\setRegion{#1}
}

\newcommand{\newCity}[3]{
	\newEntity{#1}{city}{#2}{#3}
	\directlua{SetDescriptor(CurrentLabel,"parent", CurrentRegion)}
	\setCity{#1}
}

\newcommand{\declarePC}[1]{
	\directlua{DeclarePC("#1")}
}

\newcommand{\newNPC}[3]{
	\directlua{
		NewCharacter("#1", [[\detokenize{#2}]], [[\detokenize{#3}]])
		SetLocation(CurrentLabel)
	}
}

\newcommand{\newGod}[3]{
	\newEntity{#1}{god}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newOrganisation}[3]{
	\newEntity{#1}{organisation}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newShip}[3]{
	\newEntity{#1}{ship}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newLanguage}[3]{
	\newEntity{#1}{language}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newForest}[3]{
	\newEntity{#1}{forest}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newGrassland}[3]{
	\newEntity{#1}{grassland}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newRange}[3]{
	\newEntity{#1}{range}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newMountain}[3]{
	\newEntity{#1}{mountain}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newRiver}[3]{
	\newEntity{#1}{river}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\newItem}[3]{
	\newEntity{#1}{item}{#2}{#3}
	\directlua{SetLocation(CurrentLabel)}
}

\newcommand{\addDescriptor}[3][]{
	\directlua{
		SetDescriptor(CurrentLabel,[[\detokenize{#2}]],[[\detokenize{#3}]], [[\detokenize{#1}]])
	}
}

\newcommand{\setDescription}[1]{
	\directlua{
		SetDescriptor(CurrentLabel,[[Beschreibung]],[[\detokenize{#1}]])
	}
}

\newcommand{\setEtymology}[1]{
	\directlua{
		SetDescriptor(CurrentLabel,[[Etymologie]],[[\detokenize{#1}]])
	}
}

\newcommand{\setStats}[1]{
	\directlua{
		SetDescriptor(CurrentLabel,[[Werte]],[[\detokenize{#1}]])
	}
}

\newcommand{\setSpells}[1]{
	\directlua{
		SetDescriptor(CurrentLabel,[[Zauber]],[[\detokenize{#1}]])
	}
}

\newcommand{\setLocation}[1]{
	\directlua{SetLocation(CurrentLabel, "#1")}
}

\newcommand{\setAssociation}[2][]{
	\directlua{SetAssociation(CurrentLabel, "#2", "#1")}
}

\newcommand{\automatedChapters}{
	\input{../shared/geography/all.tex}
	\input{../shared/npcs/all.tex}
	\input{../shared/associations/all.tex}
	\input{../shared/languages/all.tex}
	\input{../shared/landmarks/all.tex}
	\input{../shared/items/all.tex}
	\directlua{AutomatedChapters()}
}

\newcommand{\automatedChaptersFUCKINGEVERYTHING}{
	\input{../shared/geography/all.tex}
	\input{../shared/npcs/all.tex}
	\input{../shared/associations/all.tex}
	\input{../shared/languages/all.tex}
	\input{../shared/landmarks/all.tex}
	\input{../shared/items/all.tex}
	\directlua{AddAllEntitiesToPrimaryRefs()}
	\directlua{AutomatedChapters()}
}

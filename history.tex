
\begin{luacode*}
dofile(RelativePath .. "history.lua")
\end{luacode*}

\newcommand{\addHistory}[3][0]{
		\directlua{
			AddEvent(CurrentEntity(), #2, [[\detokenize{#3}]], #1)
		}
}

\newcommand{\addSecretHistory}[3][0]{
		\directlua{
			AddEvent(CurrentEntity(), #2, [[\detokenize{#3}]], #1, true)
		}
}

\newcommand{\addHistoryDjo}[3][0]{
	\directlua{
		AddEvent(CurrentEntity(), ConvertYearToVin(#2, YearFmtDjo), [[\detokenize{#3}]], #1)
	}
}

\newcommand{\addSecretHistoryDjo}[3][0]{
	\directlua{
		AddEvent(CurrentEntity(), ConvertYearToVin(#2, YearFmtDjo), [[\detokenize{#3}]], #1, true)
	}
}

\newcommand{\addHistoryNar}[3][0]{
	\directlua{
		AddEvent(CurrentEntity(), ConvertYearToVin(#2, YearFmtNar), [[\detokenize{#3}]], #1)
	}
}

\newcommand{\concerns}[1]{}
\newcommand{\birthof}[1]{}
\newcommand{\deathof}[1]{}

\newcommand{\born}[3][0]{
	\addHistory[#1]{#2}{#3}
	\addDescriptor{born}{#2}
}

\newcommand{\bornDjo}[3][0]{
	\addHistoryDjo[#1]{#2}{#3}
	\directlua{
		SetDescriptor(CurrentEntity(),"born",tostring(ConvertYearToVin(#2, YearFmtDjo)))
	}
}

\newcommand{\bornNar}[3][0]{
	\addHistoryNar[#1]{#2}{#3}
	\directlua{
	SetDescriptor(CurrentEntity(),"born",tostring(ConvertYearToVin(#2, YearFmtNar)))
	}
}

\newcommand{\died}[3][0]{
	\addHistory[#1]{#2}{#3}
	\addDescriptor{died}{#2}
}

\newcommand{\diedDjo}[3][0]{
	\addHistoryDjo[#1]{#2}{#3}
	\directlua{
		SetDescriptor(CurrentEntity(),"died",ConvertYearToVin(#2, YearFmtDjo))
	}
}

\newcommand{\diedNar}[3][0]{
	\addHistoryNar[#1]{#2}{#3}
	\directlua{
		SetDescriptor(CurrentEntity(),"died",ConvertYearToVin(#2, YearFmtNar))
	}
}
\usepackage{luacode}
\usepackage{nameref}

\newcommand{\LoreTex}{Lore\TeX}
\newcommand{\LoreTexSort}[1]{}

\newcommand{\loadLuacode}[1]{
    \directlua{
        dofile([[#1]] .. "/state.lua")
        dofile([[#1]] .. "/common.lua")

        dofile([[#1]] .. "/comparer.lua")
        dofile([[#1]] .. "/debug.lua")
        dofile([[#1]] .. "/dates-and-years.lua")
        dofile([[#1]] .. "/dictionary.lua")
        dofile([[#1]] .. "/errors.lua")
        dofile([[#1]] .. "/scoped-variables.lua")
        dofile([[#1]] .. "/translation.lua")
        dofile([[#1]] .. "/units.lua")

        dofile([[#1]] .. "/entities/affiliations.lua")
        dofile([[#1]] .. "/entities/api.lua")
        dofile([[#1]] .. "/entities/characters.lua")
        dofile([[#1]] .. "/entities/common.lua")
        dofile([[#1]] .. "/entities/descriptors.lua")
        dofile([[#1]] .. "/entities/getEntities.lua")
        dofile([[#1]] .. "/entities/height.lua")
        dofile([[#1]] .. "/entities/history-processing.lua")
        dofile([[#1]] .. "/entities/history-api.lua")
        dofile([[#1]] .. "/entities/nameMarkers.lua")
        dofile([[#1]] .. "/entities/names.lua")
        dofile([[#1]] .. "/entities/print-descriptors.lua")
        dofile([[#1]] .. "/entities/print.lua")
        dofile([[#1]] .. "/entities/processing.lua")
        dofile([[#1]] .. "/entities/protected-descriptors-api.lua")
        dofile([[#1]] .. "/entities/protected-descriptors-get-set.lua")
        dofile([[#1]] .. "/entities/refs.lua")
        dofile([[#1]] .. "/entities/species.lua")
        dofile([[#1]] .. "/entities/subentity.lua")
        dofile([[#1]] .. "/entities/types.lua")
        dofile([[#1]] .. "/entities/visibility.lua")

        dofile([[#1]] .. "/ffi/convert.lua")
        dofile([[#1]] .. "/ffi/lorecore.lua")
        dofile([[#1]] .. "/ffi/reading-database.lua")
        dofile([[#1]] .. "/ffi/writing-database.lua")

        ResetState()
        RelativePath = [[#1]]
    }

    \input{#1/dates-and-years.tex}
    \input{#1/debug.tex}
    \input{#1/dictionary.tex}
    \input{#1/errors.tex}
    \input{#1/scoped-variables.tex}
    \input{#1/state.tex}
    \input{#1/translation.tex}
    \input{#1/units.tex}

    \input{#1/entities/history.tex}
    \input{#1/entities/protected-descriptors.tex}
    \input{#1/entities/common.tex}
    \input{#1/entities/refs.tex}
    \input{#1/entities/types.tex}
    \input{#1/entities/visibility.tex}

    \input{#1/ffi/reading-database.tex}
    \input{#1/ffi/writing-database.tex}
}
